---
purpose: "Private technical source of truth for Quick Start and onboarding API contracts"
status: "active"
last_reviewed: "2026-01-19"
updated: "2026-01-19"
architectural_pivot: "2026-01-19"
---

# Onboarding API Specification

> **Architectural Pivot (2026-01-19)**: Phase 0 was simplified from a 7-stage AI conversation to **Quick Start** - a single form submission. The Founder's Brief is now generated by Phase 1 from AI research, not collected during onboarding. See [ADR-006](../../../startupai-crew/docs/adr/006-quick-start-architecture.md) for rationale.

## Architecture

### Quick Start Flow (Jan 2026)

Quick Start replaces the previous Two-Pass Architecture:

1. User enters business idea (1-3 sentences)
2. Optionally uploads pitch deck or pastes notes
3. System creates project with `raw_idea`
4. System triggers Phase 1 via Modal `/kickoff`
5. User redirected to dashboard

**No AI in the critical path. 30 seconds. 100% deterministic.**

### Key Files (This Repo)

- `/api/projects/quick-start/route.ts` - Quick Start submission (NEW)
- `/components/onboarding/QuickStartForm.tsx` - Simple form UI (NEW)

### Deprecated Files

The following files are deprecated by the Quick Start pivot:

- `/api/onboarding/*/route.ts` - Legacy 7-stage endpoints
- `/api/chat/*/route.ts` - Legacy chat streaming
- `/lib/onboarding/founder-quality-assessment.ts` - No assessment needed
- `/lib/onboarding/founder-stages-config.ts` - No stages needed
- `/lib/ai/founder-onboarding-prompt.ts` - No AI conversation

## Backend Integration

**Modal Serverless:** Quick Start triggers Phase 1 directly on Modal.

- **Quick Start:** Simple form submission, no AI
- **Phase 1:** AI research + Brief generation on Modal
- **HITL:** `approve_discovery_output` checkpoint (Brief + VPC combined)
- **Configuration:** See `startupai-crew/docs/master-architecture/reference/modal-configuration.md`

The CrewAI backend handles strategic validation with 4 flows, 14 crews, and 43 specialist agents.

---

## Active Endpoints

### `/api/projects/quick-start` (NEW)

**POST** - Create project and trigger Phase 1.

#### Request

```jsonc
{
  "raw_idea": "A meal planning app that helps busy parents reduce food waste and save time on weekly meal decisions",
  "additional_context": "Optional notes or extracted pitch deck text",
  "client_id": "uuid (optional - for consultant flow)"
}
```

#### Validation Rules

- `raw_idea`: Required, min 10 characters
- `additional_context`: Optional, max 10,000 characters
- `client_id`: Optional UUID, must be existing Founder account

#### Response (success)

```jsonc
{
  "success": true,
  "project_id": "uuid",
  "validation_run_id": "uuid",
  "status": "phase_1_started",
  "redirect_url": "/projects/{project_id}",
  "message": "Phase 1 started. You will be notified when discovery is complete."
}
```

#### Behaviour

1. Validate input
2. Create `project` record with `raw_idea` field
3. Create `validation_run` record
4. Call Modal `/kickoff` with `raw_idea` + `additional_context`
5. Return project ID and redirect URL

#### Errors

| Code | Description |
|------|-------------|
| `INVALID_REQUEST` | Missing or invalid `raw_idea` |
| `CLIENT_NOT_FOUND` | `client_id` specified but user not found |
| `WORKFLOW_TRIGGER_FAILED` | Modal kickoff failed |
| `PROJECT_CREATION_FAILED` | Database error |

---

## Deprecated Endpoints

> **DEPRECATED (2026-01-19)**: The following endpoints are deprecated by Quick Start. They may be removed in a future release.

### Session Lifecycle (DEPRECATED)

| Endpoint | Status | Replacement |
|----------|--------|-------------|
| `/api/onboarding/start` | DEPRECATED | `/api/projects/quick-start` |
| `/api/onboarding/status` | DEPRECATED | `/api/projects/[id]/status` |
| `/api/onboarding/pause` | DEPRECATED | Not needed (no conversation) |
| `/api/onboarding/abandon` | DEPRECATED | Not needed |
| `/api/onboarding/recover` | DEPRECATED | Not needed |
| `/api/onboarding/revise` | DEPRECATED | Edit via HITL approval |
| `/api/onboarding/complete` | DEPRECATED | Integrated into Quick Start |
| `/api/onboarding/brief` | DEPRECATED | Phase 1 generates brief |
| `/api/onboarding/queue` | DEPRECATED | Not needed |

### Chat Endpoints (DEPRECATED)

| Endpoint | Status | Replacement |
|----------|--------|-------------|
| `/api/chat/stream` | DEPRECATED | No streaming needed |
| `/api/chat/save` | DEPRECATED | No conversation to save |
| `/api/chat` (legacy) | DEPRECATED | No chat |

---

## Plan Limits

`PLAN_LIMITS` constant:

| Plan | Projects / month | Analysis workflows / month |
| --- | --- | --- |
| trial | 3 | 3 |
| sprint | 5 | 5 |
| founder | 15 | 25 |
| enterprise | 100 | 200 |

Violations return `PROJECT_LIMIT_EXCEEDED` with `fallbackOptions` (upgrade, contact_support).

## Security & Compliance

- Requires Supabase session cookie; unauthenticated calls receive 401
- No service-role usage except in admin utilities/tests
- Logs redact PII before forwarding to PostHog
- Rate limiting enforced at edge (Netlify)

## Error Response Format

All errors follow this structure:

```jsonc
{
  "success": false,
  "error": {
    "code": "PROJECT_NOT_FOUND",
    "message": "The specified project does not exist",
    "retryable": false,
    "fallbackOptions": ["create_new"]
  }
}
```

## Related Documentation

- **Master Architecture**: See [ADR-006](../../../startupai-crew/docs/adr/006-quick-start-architecture.md)
- **Phase 0 Spec**: See [04-phase-0-onboarding.md](../../../startupai-crew/docs/master-architecture/04-phase-0-onboarding.md)
- **Consultant API**: See [api-consultant.md](api-consultant.md)
- **CrewAI Integration**: See [api-crewai.md](api-crewai.md)
- **Approvals (HITL)**: See [api-approvals.md](api-approvals.md)

---

## Appendix: Legacy Two-Pass Architecture (Historical Reference)

> **HISTORICAL**: This section documents the deprecated Two-Pass Architecture for reference only.

The previous architecture used:
- Pass 1: LLM streams conversation via `/api/chat/stream`
- Pass 2: Backend deterministically assesses quality
- 7 stages: Problem → Customer → Solution → Market → Competition → Validation → Summary

This was replaced because:
- 57-92% progress variance across identical inputs
- $17+ AI cost per test run
- E2E test flakiness

See [ADR-006](../../../startupai-crew/docs/adr/006-quick-start-architecture.md) for full rationale.
