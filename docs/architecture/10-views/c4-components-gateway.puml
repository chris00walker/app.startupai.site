@startuml C4_Components_Gateway
!includeurl https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml
!includeurl https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

Container_Boundary(gateway, "Gateway (Cloud Run)") {
  Component(api, "Public API", "Express/Nest", "HTTP/JSON + OpenAPI")
  Component(auth, "Auth Middleware", "Express/Nest", "OAuth/OIDC, JWT verification")
  Component(rate, "Rate Limiter", "Middleware", "Burst + sustained control")
  Component(status, "Status/Health", "Endpoint", "Liveness, readiness, build info")
}

Component(orchestrator, "Orchestrator API", "HTTP/gRPC")

Rel(api, auth, "Validate token")
Rel(auth, rate, "Throttle")
Rel(api, status, "Expose health")
Rel(api, orchestrator, "Forward intake requests")

SHOW_LEGEND()
@enduml
